# 08. ğŸŸ¦ ì‚¬ìš©ì ì •ì˜ íƒ€ì… ê°€ë“œ

## ğŸ“Œ 0.typeof, instanceof?

### ğŸ” 1. typeof

âœ… ê°œë…:
ê¸°ë³¸ íƒ€ì…(number, string, boolean, undefined, symbol, bigint, function, object)ì„ êµ¬ë¶„í•  ìˆ˜ ìˆìŒ

ì›ì‹œ ê°’(primitive value)ì— ì£¼ë¡œ ì‚¬ìš©

```ts
typeof 123; // "number"
typeof "hello"; // "string"
typeof true; // "boolean"
typeof undefined; // "undefined"
typeof Symbol(); // "symbol"
typeof BigInt(1); // "bigint"
typeof function () {}; // "function"
typeof {}; // "object"
typeof null; // "object" â—ï¸ (ë²„ê·¸ì´ì ì—­ì‚¬ì  ìœ ì‚°)
```

### ğŸ” 2. instanceof

âœ… ê°œë…:
ê°ì²´ê°€ ì–´ë–¤ ìƒì„±ì í•¨ìˆ˜ì˜ ì¸ìŠ¤í„´ìŠ¤ì¸ì§€ í™•ì¸í•  ë•Œ ì‚¬ìš©

í”„ë¡œí† íƒ€ì… ì²´ì¸ì„ ë”°ë¼ í™•ì¸

âœ… ì‚¬ìš© ì˜ˆ:

```ts
	class Person {}
	const p = new Person();

	p instanceof Person  // true
	[] instanceof Array  // true
	[] instanceof Object // true (ArrayëŠ” Objectë¥¼ ìƒì†)
	null instanceof Object // false â—ï¸

	function Dog() {}
	const d = new Dog();
	d instanceof Dog // true
```

## ğŸ“Œ 1. íƒ€ì… ê°€ë“œë€?

- íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ìœ ë‹ˆì˜¨ íƒ€ì…ì„ ë¶„ê¸°í•´ì„œ ì•ˆì „í•˜ê²Œ ì¢íˆëŠ” ë¡œì§
  - ëŒ€í‘œì ì¸ ì˜ˆ: typeof, instanceof, "prop" in obj

## ğŸ“Œ 2. ì‚¬ìš©ì ì •ì˜ íƒ€ì… ê°€ë“œ (Custom Type Guard)

ê¸°ë³¸ íƒ€ì…ê°€ë“œ

```ts
interface Cat {
	meow: number;
}
interface Dog {
	bow: number;
}

// ê¸°ë³¸ íƒ€ì… ê°€ë“œ
// a is Dog	í•¨ìˆ˜ê°€ trueë¥¼ ë°˜í™˜í•  ê²½ìš°, aëŠ” Dog íƒ€ì…ì´ë¼ê³  íŒë‹¨

function catOrDog(a: Cat | Dog): a is Dog {
	// íƒ€ì… íŒë³„ì„ í•  ìˆ˜ ìˆëŠ” í•¨ìˆ˜
	if ((a as Cat).meow) {
		return false;
	}
	return true;
}

const cat: Cat | Dog = { meow: 3 };

if (catOrDog(cat)) {
	console.log(cat.meow);
}
if ("meow" in cat) {
	console.log(cat.meow);
}
```

## ğŸ“Œ 3. PromiseSettledResult`<T>` í•„í„°ë§

ğŸ”¹ PromiseSettledResultë€?

```
type PromiseSettledResult<T> =
	| PromiseFulfilledResult<T>
	| PromiseRejectedResult
```

- .allSettled()ì—ì„œ ì‚¬ìš©ë¨
  - ëª¨ë“  Promiseê°€ ëë‚  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¼
  - ì„±ê³µí•´ë„, ì‹¤íŒ¨í•´ë„ ì „ë¶€ ë°˜í™˜í•¨ âœ…
  - ê²°ê³¼ ë°°ì—´ì€ ë‹¤ìŒê³¼ ê°™ì€ í˜•íƒœ:

```ts
    -  ì„±ê³µ : { status: "fulfilled", value: 1 },
    -  ì‹¤íŒ¨ : { status: "rejected", reason: "ì—ëŸ¬" },

	- ì„±ê³µ â†’ { status: "fulfilled", value: T }
	- ì‹¤íŒ¨ â†’ { status: "rejected", reason: any }
```

### âœ… ì‹¤íŒ¨í•œ ê²°ê³¼ë§Œ í•„í„°ë§

```ts
// ì‹¤íŒ¨í•œê²ƒë§Œ ê°€ì ¸ì˜¤ê³  ì‹¶ì„ë•Œ
const isRejected = (input: PromiseSettledResult<unknown>): input is PromiseRejectedResult =>
	input.status === "rejected";
```

### âœ… ì„±ê³µí•œ ê²°ê³¼ë§Œ í•„í„°ë§

```ts
const isFulfilled = <T>(input: PromiseSettledResult<T>): input is PromiseFulfilledResult<T> =>
	input.status === "fulfilled";
```

## ğŸ“Œ 4. Promise ìƒíƒœ ìš”ì•½

| ìƒíƒœ      | ì„¤ëª…                           |
| --------- | ------------------------------ |
| pending   | ì•„ì§ ì‹¤í–‰ ì¤‘                   |
| fulfilled | ì„±ê³µ ì™„ë£Œ â†’ .then()            |
| rejected  | ì‹¤íŒ¨ ì™„ë£Œ â†’ .catch()           |
| settled   | ì™„ë£Œë¨ (fulfilled or rejected) |

Promiseì˜ ìƒíƒœ

- Panding
  - settled
    - ì„±ê³µ : resolved
    - ì‹¤íŒ¨ : rejected

```ts
// Promise
// ì„±ê³µ resolved
// ì‹¤íŒ¨ rejected

// sattled : .then().catch()
// ì„±ê³µ resolved .then()
// ì‹¤íŒ¨ rejected .catch()

const results: PromiseSettledResult<number>[] = await Promise.allSettled([Promise.resolve(1), Promise.reject("err")]);

const successOnly = results.filter(isFulfilled); // íƒ€ì…ì€ PromiseFulfilledResult<number>[]
const failureOnly = results.filter(isRejected); // íƒ€ì…ì€ PromiseRejectedResult[]

promise.then().catch();
```

```ts
const getUser = (id: number) => {
	if (id === 2) Promise.reject("âŒ ì‹¤íŒ¨");
	else Promise.resolve({ id, name: `User ${id}` });
};
const requests = [1, 2, 3].map(getUser);
const results = await Promise.allSettled(requests);

//[
//  { status: "fulfilled", value: { id: 1, name: "User 1" } },
//  { status: "rejected", reason: "âŒ ì‹¤íŒ¨" },
//  { status: "fulfilled", value: { id: 3, name: "User 3" } }
//]
```
