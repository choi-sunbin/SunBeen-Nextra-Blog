# ì¿ ë²„ë„¤í‹°ìŠ¤ ì„¤ì¹˜

### ì¿ ë²„ë„¤í‹°ìŠ¤ ê¸°ë³¸ êµ¬ì¡°

```
ì¿ ë²„ë„¤í‹°ìŠ¤ëŠ” í´ëŸ¬ìŠ¤í„° ë‹¨ìœ„ë¡œ ì„¤ì¹˜ëœë‹¤.
ê° ë…¸ë“œì— ë°°í¬ëœ ì»´í¬ë„ŒíŠ¸ë“¤ì´ ì»¨í…Œì´ë„ˆë¥¼ í†µì œí•˜ê³  ì‹¤í–‰í•œë‹¤.
ì „ì²´ ì‹œìŠ¤í…œì„ ìë™í™”í•˜ëŠ” ë¶„ì‚° ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ í”Œë«í¼ì´ë‹¤.

1. ì¿ ë²„ë„¤í‹°ìŠ¤(Kubernetes)
		â””â”€ ë¶„ì‚° ì‹œìŠ¤í…œ ì „ì²´ë¥¼ ì•„ìš°ë¥´ëŠ” "ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ í”Œë«í¼"
2. í´ëŸ¬ìŠ¤í„°(Cluster)
		â””â”€ ì¿ ë²„ë„¤í‹°ìŠ¤ê°€ ê´€ë¦¬í•˜ëŠ” "ë…¼ë¦¬ì  í•˜ë‚˜ì˜ ë‹¨ìœ„"
		â””â”€ í•˜ë‚˜ì˜ í´ëŸ¬ìŠ¤í„° = í•˜ë‚˜ì˜ ì¿ ë²„ë„¤í‹°ìŠ¤ ìš°ì£¼
3. ë§ˆìŠ¤í„° ë…¸ë“œ + ì›Œì»¤ ë…¸ë“œ
		â”œâ”€ ë§ˆìŠ¤í„° ë…¸ë“œ (Control Plane): ì§€íœ˜ì, ì§€ì‹œ ë‚´ë¦¼
		â””â”€ ì›Œì»¤ ë…¸ë“œ (Worker Node): ì‹¤ì œ ì»¨í…Œì´ë„ˆ ì‹¤í–‰, ì¼ê¾¼
4. ê° ë…¸ë“œì—ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ ì»´í¬ë„ŒíŠ¸ë“¤ì´ ì„¤ì¹˜ë¨
		â””â”€ kubelet, kube-proxy, container runtime ë“±
5. ì´ ì»´í¬ë„ŒíŠ¸ë“¤ì´ ì»¨í…Œì´ë„ˆ í™˜ê²½ì„ ì¡°ì„±í•¨
		â””â”€ ì»¨í…Œì´ë„ˆëŠ” Podë¡œ ê°ì‹¸ì ¸ ì‹¤í–‰ë¨ (ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ ìµœì†Œ ë‹¨ìœ„)
6. ì „ì²´ê°€ í†µí•©ë˜ì–´ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ê°€ ë™ì‘í•¨

[ ì¿ ë²„ë„¤í‹°ìŠ¤ ]
       â”‚
       â–¼
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ í´ëŸ¬ìŠ¤í„° 1 â”‚ â—€â”€â”€ ê°€ì¥ í° ë‹¨ìœ„
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€ ğŸ“¡ ë§ˆìŠ¤í„° ë…¸ë“œ
       â”‚     â””â”€ API Server, Scheduler, etcd, ...
       â”‚
       â”œâ”€â”€ ğŸ§± ì›Œì»¤ ë…¸ë“œ 1
       â”‚     â””â”€ kubelet, kube-proxy, container runtime
       â”‚
       â””â”€â”€ ğŸ§± ì›Œì»¤ ë…¸ë“œ 2 ...

```

# ì„¤ì¹˜ ìˆœì„œ

- Vagrant ì„¤ì¹˜
- Virtual Boxì„¤ì¹˜
- Script íŒŒì¼ ì‹¤í–‰ â†’ ì¿ ë²„ë„¤í‹°ìŠ¤ ì„¤ì¹˜ ì™„ë£Œ
- MobaXtermì„ í™•ì¸í•´ì„œ
- ì›ê²©ì ‘ì†
- Kubernates Pods ìƒíƒœí™•ì¸
- ëŒ€ì‹œë³´ë“œ ì ‘ì†

### ì˜ˆì‹œ ì»´í“¨í„° ìì›

## VirtualBox Rocky Linux ìƒì„±

![image.png](./image.png)

![image.png](./image%201.png)

![image.png](./image%202.png)

- config.vm.box = "rockylinux/8"
  - "Rocky linux 8 ì„¤ì¹˜" - ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ì‹œê°„ ê±¸ë¦¼
- config.vm.define "master-node" do |master|
  - Virtual ë°•ìŠ¤ VMì˜ ì´ë¦„ì„ "master-node"ë¡œ ì„¤ì •
- master.vm.hostname = "k8s-master"
  - Hostname ì„¤ì • : k8s-maste
- master.vm.network "private_network", ip: "192.168.56.30"
  - private_network : Host Only Network ì„¤ì •
    - Host Only Network : ë‚´ PCì—ì„œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë„¤íŠ¸ì›Œí¬ ë§
  - ip: "192.168.56.30" ë¦¬ëˆ…ìŠ¤ì˜ IP ì„¤ì •
- ìì› í• ë‹¹
  - vb.memory = **4096 (ë©”ëª¨ë¦¬)**
    - **ì»´í“¨í„° ìì› 16g ì—ì„œ 4g í• ë‹¹ ë°›ì•„ ì‚¬ìš©**
  - vb.cpus = **4 (CPU 4 core) ì‚¬ìš©**
    - CPUëŠ” í•„ìš”í•œ ìˆœê°„ ìì›ì„ ê°€ì ¸ì™€ ì‚¬ìš©í•˜ëŠ” ì²˜ë¦¬ í”„ë¡œì„¸ì„œ
    - ì‹¤ì œë¡œëŠ” **í˜¸ìŠ¤íŠ¸ì˜ CPUë¥¼ ê³µìœ **í•˜ë¯€ë¡œ, ë™ì¼í•œ 4ì½”ì–´ë¥¼ ì‚¬ìš©í•´ë„ í•­ìƒ 4ì½”ì–´ë¥¼ ì ìœ í•˜ì§€ ì•ŠìŒ
    - ì¿ ë²„ë„¤í‹°ìŠ¤ì—ì„œ ê¶Œê³  í•˜ëŠ” ìµœì†Œ CPU í• ë‹¹ëŸ‰ì€ 2 ì½”ì–´ì´ìƒ

### NAT (Network Address Translation)

- Vagrantê°€ VMì„ ìƒì„±í•˜ë©´ ê¸°ë³¸ìœ¼ë¡œ NAT ë„¤íŠ¸ì›Œí¬ë¥¼ ì„¤ì •í•¨
- VMì´ ì¸í„°ë„·(ì™¸ë¶€)ê³¼ í†µì‹  ê°€ëŠ¥í•˜ê²Œ í•´ì¤Œ
- **ì˜ˆ: íŒ¨í‚¤ì§€ ì„¤ì¹˜, yum update, containerd, kubeadm ë‹¤ìš´ë¡œë“œ ì‹œ ì‚¬ìš©ë¨**

## Kubernates Cluster ì„¤ì¹˜

ì—¬ëŸ¬ ê°€ì§€ ë°©ë²•ì´ ìˆì§€ë§Œ, **Kubeadm**ì„ ì´ìš©í•œë‹¤.

**ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ë¹ ë¥´ê²Œ ì„¤ì¹˜(bootstrap)** í•˜ê¸° ìœ„í•œ **ê³µì‹ ì„¤ì¹˜ ë„êµ¬**

### ê³µì‹ ë¬¸ì„œ

[https://kubernetes.io/ko/docs/setup/production-environment/tools/kubeadm/install-kubeadm/](https://kubernetes.io/ko/docs/setup/production-environment/tools/kubeadm/install-kubeadm/)

![image.png](./image%203.png)

í•„ìš” ì¤€ë¹„ ì‚¬í•­

- ë°ë¹„ì•ˆ ê¸°ë°˜ Linux ë¨¸ì‹  or ë ˆë“œí–‡ ê¸°ë°˜ Linux ë¨¸ì‹ 
- 2 GB Ram ì´ìƒ
- 2 Core CPU ì´ìƒ
- ê°ê°ì˜ ì›Œì»¤ ë…¸ë“œì˜ ê³ ìœ ì„±
  - ì—¬ëŸ¬ ì›Œì»¤ ë…¸ë“œë¥¼ êµ¬ì„±í• ë•Œ : VM ìœ¼ë¡œ ì›Œì»¤ë…¸ë“œë¥¼ ë§Œë“¤ì–´ ë³µì‚¬í•´ì„œ ëŠ˜ë ¤ ì‚¬ìš©í•˜ê¸°ë„ í•¨
  - ê¸°ë³¸ ì„¸íŒ…ì„ í• ë•ŒëŠ” ë˜‘ê°™ìœ¼ë‹ˆê¹Œ VM ë³µì‚¬ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ê¸°ë„ í•˜ì§€ë§Œ ì´ë•Œ ê³ ìœ í•œ ì†ì„±(Mac ì£¼ì†Œ, í˜¸ìŠ¤íŠ¸ ì´ë¦„, product_uuid)ë“±ê¹Œì§€ ê·¸ëŒ€ë¡œ ë³µì‚¬í•˜ê±°ë‚˜ ìƒˆë¡œ ë¶€ì—¬í•  ìˆ˜ ìˆëŠ” ì˜µì…˜ì´ ì¡´ì¬
  - ê³ ìœ  ì†ì„±ê¹Œì§€ ë³µì‚¬í•˜ë©´ ì˜¤ë¥˜ê°€ ë‚œë‹¤.
- ì¿ ë²„ë„¤í‹°ìŠ¤ êµ¬ì„±ë“¤ ë¼ë¦¬ ì„œë¡œ í†µì‹ í•  ëª©ì ì˜ íŠ¹ì • í¬íŠ¸ë¥¼ ê°œë°©í•´ì•¼í•œë‹¤.
  - ë°©í™”ë²½ ìì²´ë¥¼ ë‚´ë ¤ë²„ë¦¬ë©´, ì–´ë– í•œ í¬íŠ¸ë„ ë§‰íˆì§€ ì•ŠëŠ”ë‹¤. (êµìœ¡ ëª©ì )
- ìŠ¤ì™‘ ë¹„í™œì„±í™”
  - ìŠ¤ì™‘ : RAMì´ ë¶€ì¡±í•  ë•Œ ë””ìŠ¤í¬ ê³µê°„ ì¼ë¶€ë¥¼ ì„ì‹œ ë©”ëª¨ë¦¬ì²˜ëŸ¼ ì‚¬ìš©í•˜ëŠ” ê¸°ìˆ 

ì„œë¡œ ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì´ ë˜ì–´ìˆì–´ì•¼ëœë‹¤.

## ì¿ ë²„ë„¤í‹°ìŠ¤ ì„¤ì¹˜ ( ëª¨ë“  Node )

1. Rocky linux ê¸°ë³¸ ì„¤ì • : íŒ¨í‚¤ì§€ ì—…ë°ì´íŠ¸, íƒ€ì„ì¡´ ì„¤ì •
2. kubeadm ì„¤ì¹˜ ì „ ì‚¬ì „ì‘ì—… : ë°©í™”ë²½ í•´ì œ, ìŠ¤ì™‘ ë¹„í™œì„±í™”
3. ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ ì„¤ì¹˜
   - [3-1] ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ì„ ì„¤ì¹˜í•˜ê¸° ì „ ì‚¬ì „ ì‘ì—…
     - IPv4 í¬ì›Œë”© iptables ì„¸íŒ…
     - cgroup ë“œë¼ì´ë²„ ì„¤ì •
   - [3-2] ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ (containerd ì„¤ì¹˜)
     - [3-2-1] containerd ì„¤ì¹˜ (option 2)
       - [3-2-1-1] Docker Engine ì„¤ì¹˜ : repo ì„¤ì •, containerd ì„¤ì¹˜
   - [3-3] ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ : cri í™œì„±í™”
4. kubeadm ì„¤ì¹˜
   - ì„¤ì •
     - repo ì„¤ì •
     - SELinux ì„¤ì •
   - íŒ¨í‚¤ì§€ ì„¤ì¹˜
     - kubelet
     - kubeadm
     - kubectl

Master Node ì„¸íŒ…

1. Kubeadmìœ¼ë¡œ í´ëŸ¬ìŠ¤í„° ìƒì„±
   - [1-1] í´ëŸ¬ìŠ¤í„° ì´ˆê¸°í™” (Pod Network ì„¸íŒ…)
   - [1-2] kubectl ì‚¬ìš© ì„¤ì •
   - [1-3] CNI Plugin ì„¤ì¹˜ (calico)
   - [1-4] Masterì— Pod ë¥¼ ìƒì„± í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •
2. ì¿ ë²„ë„¤í‹°ìŠ¤ í¸ì˜ ê¸°ëŠ¥ ì„¤ì¹˜
   - [2-1] kubectl ìë™ì™„ì„± ê¸°ëŠ¥
   - [2-2] Dashboard ì„¤ì¹˜
   - [2-3] Metrics Server ì„¤ì¹˜

## cgroup (control groups)

- ë¦¬ëˆ…ìŠ¤ì—ì„œ **CPU, ë©”ëª¨ë¦¬, ë””ìŠ¤í¬, ë„¤íŠ¸ì›Œí¬ ë“±ì˜ ë¦¬ì†ŒìŠ¤ë¥¼ í”„ë¡œì„¸ìŠ¤ ë‹¨ìœ„ë¡œ ì œì–´**í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ê¸°ëŠ¥
- ì»¨í…Œì´ë„ˆë„ ê²°êµ­ ë¦¬ëˆ…ìŠ¤ í”„ë¡œì„¸ìŠ¤ì´ë¯€ë¡œ, **ì¿ ë²„ë„¤í‹°ìŠ¤ì™€ ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ì€ cgroupì„ í†µí•´ ë¦¬ì†ŒìŠ¤ë¥¼ ì œí•œí•¨**
- ì¿ ë²„ë„¤í‹°ìŠ¤ë‘ ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ì„ ì„¤ì¹˜í•  ë•Œ **ë™ì¼ ì„¤ì •**í•˜ëŠ”ê²ƒì´ ì¢‹ë‹¤.

### cgroup ë“œë¼ì´ë²„ë€?

> ëˆ„ê°€ ì´ cgroup ê¸°ëŠ¥ì„ **ê´€ë¦¬í•˜ê³  ì¶”ì í• ì§€ ì„ íƒí•˜ëŠ” ê²ƒ**

| ë“œë¼ì´ë²„ ì´ë¦„ | ì„¤ëª…                                                                        |
| ------------- | --------------------------------------------------------------------------- |
| `cgroupfs`    | ë…ë¦½ì ìœ¼ë¡œ cgroupì„ ì œì–´ (Dockerì˜ ê¸°ë³¸ ì„¤ì •)                               |
| `systemd`     | systemd(ë¦¬ëˆ…ìŠ¤ ì„œë¹„ìŠ¤ ë§¤ë‹ˆì €)ê°€ cgroupì„ ê´€ë¦¬í•¨ (ìµœê·¼ ì¿ ë²„ë„¤í‹°ìŠ¤ ê¶Œì¥ ë°©ì‹) |

- ìµœê·¼ **ì¿ ë²„ë„¤í‹°ìŠ¤ ê³µì‹ ê°€ì´ë“œë„ `systemd`ë¥¼ ê¶Œì¥**í•©ë‹ˆë‹¤
- íŠ¹íˆ Ubuntu, CentOS, RockyLinux ë“± systemd ê¸°ë°˜ì´ë©´ ê±°ì˜ í•„ìˆ˜

### containerd ì„¤ì¹˜

ê³µì‹ Github :

[https://github.com/containerd/containerd/blob/main/docs/getting-started.md](https://github.com/containerd/containerd/blob/main/docs/getting-started.md)

![image.png](./image%204.png)

**Option 1: From the official binaries**

ê³µì‹ ë°”ì´ë„ˆë¦¬ë¥¼ ë°›ì•„ì„œ ì„¤ì¹˜í•˜ê¸°

`containerd-<VERSION>-<OS>-<ARCH>.tar.gz`Â archive from

[https://github.com/containerd/containerd/releases](https://github.com/containerd/containerd/releases)

- Typically, you will have to installÂ [runc](https://github.com/opencontainers/runc/releases)Â andÂ [CNI plugins](https://github.com/containernetworking/plugins/releases)Â from their official sites too.
  - runCì™€ CNIëŠ” ë³„ë„ë¡œ ì„¤ì¹˜ í•´ì•¼ëœë‹¤.

runCëŠ” ë³„ë„ì˜ ì˜ì¡´ì„± íŒ¨í‚¤ì§€ë“¤ì´ ë§ë‹¤.

CNIë„ ì„¤ì¹˜ ì˜ˆì •

**Option 2: FromÂ `apt-get`Â orÂ `dnf`**

- TheÂ `containerd.io`Â packages in DEB and RPM formats are distributed by Docker (not by the containerd project)
  - Dockerì—ì„œ ì œê³µí•˜ëŠ” Containerd.ioë¥¼ ì‚¬ìš©í•˜ê¸°

ë„ì»¤ë¥¼ ì„¤ì¹˜í• ë•Œ Containerdì™€ runCê°€ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— ì‚¬ìš©ì ì¹œí™”ì ì¸ dockerë¬¸ì„œë¥¼ í™•ì¸í•´ ë³´ë©´ íŒ¨í‚¤ì§€ë¥¼ í•œë²ˆì— ì„¤ì¹˜í•˜ëŠ” ë°©ë²•ì´ ë‚˜ì™€ìˆìŒ

ì¼ë‹¨ containerd.ioë§Œ ì„¤ì¹˜ ì˜ˆì •

### Docker ë¥¼ ì´ìš©í•´ Containerd ì„¤ì¹˜

URL : [https://docs.docker.com/engine/install/centos/](https://docs.docker.com/engine/install/centos/)

![image.png](./image%205.png)

![image.png](./image%206.png)

containerd ì„¤ì¹˜ë¥¼ ìœ„í•´

```
//Containerd.io ì„¤ì¹˜ (ìµœì‹  ë²„ì „)

sudo dnf install containerd.io
```

### containerd í˜¸í™˜ì„± ì²´í¬

Kubernates 1.2.7ë²„ì „ì„ ì‚¬ìš©í•œë‹¤ê³  í•˜ë©´,

1.7.0+, 1.6.15+ ë²„ì „ì„ ì´ìš©í•˜ë©´ ëœë‹¤.

[https://github.com/containerd/containerd/blob/main/RELEASES.md](https://github.com/containerd/containerd/blob/main/RELEASES.md)

![image.png](./image%207.png)

ë¬´ì¡°ê±´ì ìœ¼ë¡œ 1.7.0ë²„ì „ì„ ì„ íƒí•˜ëŠ”ê²ƒì´ ì•„ë‹ˆë¼,

í˜„ì¬ (2025.05.21) ìµœì‹  ê¸°ìˆ ë“¤ì„ ê¼­ ì‚¬ìš©í•´ì•¼ ë˜ëŠ”ê²Œ ì•„ë‹ˆë¼ë©´, ê¸°ì¤€ LTSë¥¼ í™•ì¸í•˜ê³  ì‚¬ìš©í•˜ëŠ”ê²ƒì´ ì¢‹ì€ë°

- 1.6 LTS
- 1.7 LTS

ìƒíƒœ ì´ê¸° ë•Œë¬¸ì— 1.7 ë²„ì „ì„ ì‚¬ìš©í•˜ëŠ”ê²ƒì´ ì¢‹ë‹¤.

í•˜ì§€ë§Œ, ê°•ì˜ë¡œëŠ” 1.6ë²„ì „ì„ ì‚¬ìš©í•˜ê³ ìˆìœ¼ë‹ˆ 1.6.21 ë²„ì „ì„ ì‚¬ìš©í•  ì˜ˆì •ì´ë‹¤.

![image.png](./image%208.png)
